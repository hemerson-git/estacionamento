generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum StatusVaga {
  LIVRE
  OCUPADA
}

enum TipoVaga {
  MOTO
  CARRO
}

model Usuario {
  id_usuario Int    @id @default(autoincrement())
  nome       String @db.VarChar(50)
  login      String @unique @db.VarChar(20)
  senhaHash  String @db.VarChar(200)

  @@map("usuario")
}

model Empresa {
  id_empresa   Int      @id @default(autoincrement())
  cnpj         String   @db.Char(14)
  nome         String   @db.VarChar(100)
  endereco     String   @db.VarChar(100)
  telefone     String   @db.Char(11)
  numero_vagas Int
  valor_hora   Decimal? @db.Decimal(10, 0)
  vagas        Vaga[]

  @@map("empresa")
}

model Veiculo {
  id           Int    @id @default(autoincrement())
  placa        String @unique @db.Char(7)
  modelo       String @db.VarChar(50)
  cor          String @db.VarChar(50)
  nome_cliente String @db.VarChar(50)

  veiculo_vaga Veiculo_vaga[]

  @@map("veiculo")
}

model Vaga {
  id_vaga Int        @id @default(autoincrement())
  numero  Int
  status  StatusVaga @default(LIVRE)
  tipo    TipoVaga

  veiculo_vaga Veiculo_vaga[]
  empresa      Empresa?       @relation(fields: [empresaId], references: [id_empresa])
  empresaId    Int?

  @@map("vaga")
}

model Veiculo_vaga {
  id_veiculo   Int
  id_vaga      Int
  hora_entrada DateTime
  hora_saida   DateTime?

  veiculo Veiculo @relation(fields: [id_veiculo], references: [id])
  vaga    Vaga    @relation(fields: [id_vaga], references: [id_vaga])

  @@id([id_veiculo, id_vaga, hora_entrada])
  @@index([id_vaga], name: "fk_id_vaga")
}
